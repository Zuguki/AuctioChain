import{j as e,s as d,c as B,r as c,d as _,C as j,F as E,o as C,T as L,e as w}from"./index-de2d1123.js";import{A as S}from"./AuctionLogic-f40de452.js";import{L as F}from"./LogicDownload-41104aa4.js";import{A as V}from"./AuctionService-80fcdd5a.js";import{u as W}from"./Pagination-da7ae05b.js";import{B as I}from"./BaseListAuctions-61adb0ee.js";import"./useQuery-baed50f9.js";import"./utils-73056672.js";const $="_title_17hrm_1",T="_position_17hrm_5",f={title:$,position:T},z="_selects_1mujz_1",R="_title_1mujz_5",D="_reset_1mujz_9",v={selects:z,title:R,reset:D},k=({width:s="base",extraSmall:t=!1})=>e.jsx("hr",{className:`${d.hr} ${B(d.hrSmall,d.hrLarge)[s]} ${t&&d.hrExtraSmall}`}),H="_input_8e496_1",O="_small_8e496_26",U="_large_8e496_30",Z="_positionWrite_8e496_34",p={input:H,small:O,large:U,positionWrite:Z},G=c.memo(c.forwardRef(({changeValue:s,width:t="base",isWrite:n,...r},a)=>e.jsxs(e.Fragment,{children:[e.jsx("input",{style:{display:"inline-block"},className:`${p.input} ${B(p.small,p.large)[t]}`,placeholder:"Поиск",ref:a,...r,onChange:s}),n&&e.jsx("div",{className:p.positionWrite,children:e.jsx("div",{className:"spinner-grow text-secondary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})})]}))),Y=(s,t="search",n=1e3)=>{const[r,a]=_(),[o,l]=c.useState(r.get(t)||""),[i,u]=c.useState(!1),h=g=>{const{value:m}=g.target;u(()=>!0),l(()=>m)};return c.useEffect(()=>{const g=setTimeout(()=>{a(m=>new URLSearchParams({...Object.fromEntries(m.entries()),[t]:o})),s(m=>({...m,[t]:o})),u(()=>!1)},n);return()=>clearTimeout(g)},[o]),{stateSearch:o,changeSearch:h,isWrite:i}},q={search:"",auctionStatus:null,orderByStatus:null},J="_select_1amg1_1",K="_title_1amg1_25",M="_div_1amg1_34",x={select:J,title:K,div:M},A=c.memo(({title:s,selectors:t,changeValue:n,...r})=>e.jsxs("div",{className:x.div,children:[e.jsx("label",{className:x.title,children:s}),e.jsxs("select",{className:x.select,...r,onChange:n,children:[e.jsx("option",{children:"—"}),t.map(a=>typeof a=="string"?e.jsx("option",{value:a,children:a},a):e.jsx("option",{value:a.value,children:a.element},a.value))]})]})),y=s=>{const[,t]=_();return{changeSelect:r=>{const{value:a,name:o}=r.target,l=Number.parseInt(a)||null;s(i=>({...i,[o]:l})),t(i=>l==null?(i.delete(o),i):new URLSearchParams({...Object.fromEntries(i.entries()),[o]:String(l)}))}}},N=[{element:"A–Z",value:0},{element:"Z–A",value:1},{element:"Дате начала аукциона",value:2},{element:"Дате конца аукциона",value:3}];class Q{static getTextStatus(t){return{0:"Неизвестный",1:"Создание",2:"Ожидание торгов",3:"Торги",4:"Завершен",5:"Отменён"}[t]}static isCreation(t){return t.status===S.creation}static isBidding(t){return t.status===S.bidding}static isWaitBidding(t){return t.status===S.waitBidding}}const b=[1,2,3,4,5].map(s=>({element:Q.getTextStatus(s),value:s})),P=(s,t)=>s.find(r=>r.value===t)??null,X=()=>{var u,h;const{stateApp:s}=c.useContext(j),[t]=_(),[n,r]=c.useState({search:t.get("search")||"",auctionStatus:Number(t.get("auctionStatus"))||null,orderByStatus:Number(t.get("orderByStatus"))||null});console.log(Number(t.get("auctionStatus")));const{isWrite:a,changeSearch:o}=Y(r),{changeSelect:l}=y(r),{changeSelect:i}=y(r);return c.useEffect(()=>(s.paramsAuctions=n,()=>{s.paramsAuctions=q}),[n]),e.jsxs(E,{children:[e.jsx("h4",{className:v.title,children:"Поиск"}),e.jsx(G,{name:"search",width:"large",autoFocus:!0,autoComplete:"off",changeValue:o,error:null,errorBlur:()=>({}),isWrite:a,defaultValue:n.search}),e.jsxs("div",{className:v.selects,children:[e.jsx(A,{title:"Сортировать по:",name:"orderByStatus",selectors:N,changeValue:i,defaultValue:(u=P(N,n.orderByStatus))==null?void 0:u.value}),e.jsx(A,{title:"Фильтровать по статусу:",name:"auctionStatus",selectors:b,changeValue:l,defaultValue:(h=P(b,n.auctionStatus))==null?void 0:h.value})]}),e.jsx(k,{width:"large"})]})},tt=c.memo(C(()=>{const[s,t]=c.useState(1),{stateApp:n}=c.useContext(j),{data:{auctions:r},isLoading:a,pagination:o}=W(()=>V.getAuctions(s,L==="desktop"?12:6,n.paramsAuctions),["auctions",s,n.paramsAuctions],{auctions:[]});return e.jsx(F,{isLoading:a,children:e.jsx(I,{auctions:r,pagination:o,setCurrentPage:t})})})),lt=C(()=>{const{stateApp:s}=c.useContext(j),t=w();return c.useEffect(()=>{t.search&&(s.search=!0)},[t]),e.jsxs("div",{children:[e.jsxs("div",{className:f.position,children:[e.jsx("h1",{className:f.title,children:"Список аукционов"}),s.search&&e.jsx(X,{})]}),e.jsx(tt,{})]})});export{lt as default};
