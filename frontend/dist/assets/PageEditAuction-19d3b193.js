import{r as p,f as L,u as S,C as v,j as d,N as C,P as A,G as N}from"./index-de2d1123.js";import{A as x}from"./AuctionService-80fcdd5a.js";import{D as U}from"./DateLogic-542e517c.js";import{A as w}from"./AuctionInteraction-27ea512c.js";import{L as y}from"./LogicDownload-41104aa4.js";import{u as h}from"./usePostAPI-61665161.js";import{u as B}from"./ImageForm-31ec2828.js";import{e as G,a as O}from"./editPageLogic-85e1073c.js";import{u as V}from"./useGetAPI-8a4b8c88.js";import{u as $}from"./useDataUser-7a2b0287.js";import"./timeZone-da1aee6f.js";import"./utils-73056672.js";import"./useQuery-baed50f9.js";const{getDateByStringISO:I}=U,q=(a,o)=>{const{dateStart:e,dateEnd:t}=a;return{...a,image:o,dateStart:I(e),dateEnd:I(t)}},M=a=>{const{data:o,isLoading:e}=V(()=>x.getAuctionByID(a),["auction",a]),t=p.useMemo(()=>{const{status:g,userId:c,id:i,...m}=o;return i==null?{}:{...m,auctionId:i}},[o]),{dataUser:r,logicFormValue:s,setDataUser:u}=$(t);return p.useEffect(()=>{u(()=>t)},[t]),{dataUser:r,logicFormValue:s,loadingAuction:e,auction:o,baseAuction:t}},ot=()=>{const{id:a}=L(),{dataUser:o,loadingAuction:e,auction:t,logicFormValue:r,baseAuction:s}=M(a),{error:u,isPending:g,blurError:c,postData:i}=h(n=>x.updateAuction(n)),{setFile:m,postCorrectImage:P,imageFile:l}=B(),D=S(),{stateApp:E,userStore:F}=p.useContext(v),{userId:f,status:b}=t;if(f!==void 0&&(f!==F.user.userId||b!==1))return alert("Вам отказано в доступе!"),d.jsx(C,{to:A.auctions});const j=async()=>{const n=await O(o,s,l,c,P);if(n==null)return;await i(q(o,n))&&(D(`${A.auction}/${t.id}`),E.notification=N)};return d.jsx(y,{isLoading:e||G(s,{}),children:d.jsx(w,{submitForm:j,loading:g,error:u,logicFormValue:r,blurError:c,logicFileImage:{setFileImage:m,imageFile:l},componentInteraction:{title:"Правка аукциона",buttonText:"Отредактировать",component:s}})})};export{ot as default};
